<mat-tree class="tree-select-tree" [dataSource]="dataSource" [treeControl]="treeControl" [ngClass]="{'readonly': !to.selectable}">
    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
        <button mat-icon-button disabled></button>
        <ng-container *ngIf="to.selectable">
            <mat-checkbox class="leaf-node"
                [checked]="treeNodeSelection.isSelected(node)"
                (change)="toggleLeafSelection(node)">
                {{node.name}}
            </mat-checkbox>
        </ng-container>
        <ng-container *ngIf="!to.selectable">
            {{node.name}}
        </ng-container>
    </mat-tree-node>

    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodePadding>
        <div class="mat-tree-node">
            <button mat-icon-button matTreeNodeToggle (click)="node.expanded = !node.expanded">
                <mat-icon class="mat-icon-rtl-mirror">
                    {{node.expanded ? 'expand_more' : 'chevron_right'}}
                </mat-icon>
            </button>
            <ng-container *ngIf="to.selectable">
                <mat-checkbox [checked]="descendantsAllSelected(node)"
                    [indeterminate]="descendantsPartiallySelected(node)"
                    (change)="toggleNodeSelection(node)">
                    {{node.name}}
                </mat-checkbox>
            </ng-container>
            <ng-container *ngIf="!to.selectable">
                {{node.name}}
            </ng-container>
        </div>
        <ul>
            <ng-container matTreeNodeOutlet *ngIf="node.expanded"></ng-container>
        </ul>
    </mat-nested-tree-node>
</mat-tree>
<input type="hidden"
    [id]="id"
    [formControl]="formControl"
    [formlyAttributes]="field">